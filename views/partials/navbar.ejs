<%# views/partials/navbar.ejs %>
<%# Questo file definisce la barra di navigazione (header) del sito. %>
<%# È "sticky-top", quindi rimane fissata in cima alla pagina durante lo scorrimento. %>
<header class="p-3 mb-3 border-bottom sticky-top bg-white shadow-sm">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
        <%# Logo del sito, che funge anche da link alla homepage. %>
        <a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-dark text-decoration-none">
          <img src="/immagini/logo.png" alt="Logo" width="40" height="40" style="border-radius: 50%; object-fit: cover;">
        </a>

        <%# Lista dei link di navigazione principali. %>
        <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ms-lg-4">
          <li><a href="/" class="nav-link px-2 link-secondary header-nav-link">Home</a></li>
    
          <%# Link per visualizzare le "Novità" e le "Offerte". Usano parametri di query per filtrare i prodotti nella homepage. %>
          <li><a href="/?view=novita" class="nav-link px-2 link-dark header-nav-link">Novità</a></li>
          <li><a href="/?view=offerte" class="nav-link px-2 link-dark header-nav-link">Offerte</a></li>
          
          <%# Logica condizionale: mostra il link "Diventa un venditore" solo se l'utente non è loggato o se non è già un venditore. %>
          <% if (!user || user.tipo_account !== 'venditore') { %>
            <li><a href="/venditore" class="nav-link px-2 link-dark header-nav-link">Diventa un venditore</a></li>
          <% } %>
          
          <%# Nota per lo sviluppatore: il link al pannello admin è stato spostato nel popup del profilo. %>
          <%# --- INIZIO MODIFICA (BLOCCO RIMOSSO) --- %>
          <%# Il link per il pannello admin è stato spostato nel popup del profilo (script.js) %>
          <%# --- FINE MODIFICA --- %>
        </ul>

        <%# Form di ricerca, che invia una richiesta GET alla rotta /search. %>
        <form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search" action="/search" method="GET">
          <input type="search" name="q" class="form-control" placeholder="Cerca prodotto o utente..." aria-label="Search">
        </form>

    
        <div class="text-end">
          <div class="text-end">
            <%# Logica condizionale per il pulsante del profilo. %>
            <% if (isAuthenticated) { %>
              <%# Se l'utente è autenticato, il pulsante punta alla sua dashboard personale. L'ID 'profile-button' è usato da JavaScript per il popup. %>
              <a id="profile-button" href="/utente?section=dati" class="btn btn-primary me-2" title="Il mio Account">
                <i class="bi bi-person fs-5"></i>
              </a>
            <% } else { %>
              <%# Se l'utente non è autenticato, il pulsante punta alla pagina di registrazione. %>
              <a id="profile-button" href="/auth/registrazione" class="btn btn-primary me-2" title="Registrati">
                <i class="bi bi-person fs-5"></i>
              </a>
            <% } %>

            <%# Pulsante per il carrello. %>
            <a href="/carrello" id="cart-button" class="btn btn-primary position-relative" title="Carrello">
              <i class="bi bi-cart fs-5"></i>
              <%# Contatore degli articoli nel carrello. Viene mostrato solo se ci sono articoli. %>
              <span id="cart-counter" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                <% if (session.cart && session.cart.totalQty > 0) { %>
                  <%= session.cart.totalQty %>
                <% } %>
           
               </span>
            </a>
          </div>
        </div>
      </div>
    </div>
</header>